import{r as i,i as S,j as e,L as U,Q as c}from"./index-91e4566e.js";import{g as L,r as k,u as _,a as E}from"./index.esm2017-dfb43fad.js";import{q as m,c as p,f as x,w as h,g as f,s as q}from"./FirebaseConfig-863835c9.js";import{L as z}from"./Layout-87ba07b9.js";import F from"./Loader-d3f9bc3d.js";import{m as R}from"./myContext-58528e02.js";import"./index-bea2a320-8c0c8ce8.js";const Y=()=>{const y=i.useContext(R),{products:a,setProducts:l}=y,[w,o]=i.useState(!1),[b,d]=i.useState(!1),[u,j]=i.useState([null,null,null,null]),v=L(),g=S();i.useEffect(()=>{(async()=>{o(!0);try{const s=m(p(x,"products"),h("_id","==",g.id)),r=await f(s);if(r.empty)c.error("Product not found");else{const n=r.docs[0].data();l(n)}o(!1)}catch(s){console.log(s),o(!1)}})()},[g.id,l]);const N=(t,s)=>{const r=[...u];r[t]=s,j(r)},C=async()=>{d(!0);const t=[];try{for(const s of u)if(s){const r=k(v,`images/${s.name}`);await _(r,s);const n=await E(r);t.push(n)}return t}catch(s){return console.error("Error uploading image:",s),[]}finally{d(!1)}},P=t=>{const s=a.sizes?[...a.sizes]:[];s.includes(t)?s.splice(s.indexOf(t),1):s.push(t),l({...a,sizes:s})},D=async()=>{if(!a._id||!a.price||!a.category||!a.description||a.sizes.length===0||!a.fabric||!a.washCareInstructions)return c.error("All fields are required, including at least one size, fabric, and wash care instructions");o(!0);const t=await C();if(t.length===0)return o(!1),c.error("Error uploading images. Please try again.");try{const s={...a,imageUrls:t},r=m(p(x,"products"),h("_id","==",a._id)),n=await f(r);if(n.empty)c.error("Product not found");else{const I=n.docs[0].ref;await q(I,s),c.success("Product updated successfully"),setTimeout(()=>{window.location.href="/dashboard"},800)}o(!1)}catch(s){console.log(s),o(!1),c.error("Error updating product")}};return e.jsx(z,{children:e.jsx("div",{children:e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsxs("div",{className:"bg-gray-800 px-10 py-10 rounded-xl",style:{maxHeight:"500px",overflowY:"auto",width:"40%",margin:"auto"},children:[e.jsx("div",{className:"",children:e.jsx("h1",{className:"text-center text-white text-xl mb-4 font-bold",children:"Update Product"})}),w||b?e.jsx(F,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("input",{type:"text",value:a._id,onChange:t=>l({...a,_id:t.target.value}),name:"title",className:"bg-gray-600 mb-4 px-2 py-2 w-full lg:w-[20em] rounded-lg text-white placeholder:text-gray-200 outline-none",placeholder:"Product ID"})}),e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("input",{type:"text",value:a.price,onChange:t=>l({...a,price:t.target.value}),name:"price",className:"bg-gray-600 mb-4 px-2 py-2 w-full lg:w-[20em] rounded-lg text-white placeholder:text-gray-200 outline-none",placeholder:"Product Price"})}),e.jsx("div",{className:"mb-4",children:Array.from({length:4}).map((t,s)=>e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("input",{type:"file",onChange:r=>N(s,r.target.files[0]),className:"bg-gray-600 px-2 py-2 w-full lg:w-[20em] rounded-lg text-white placeholder:text-gray-200 outline-none"})},s))}),e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("input",{type:"text",value:a.category,onChange:t=>l({...a,category:t.target.value}),name:"category",className:"bg-gray-600 mb-4 px-2 py-2 w-full lg:w-[20em] rounded-lg text-white placeholder:text-gray-200 outline-none",placeholder:"Product Category"})}),e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("textarea",{cols:"30",rows:"10",name:"title",value:a.description,onChange:t=>l({...a,description:t.target.value}),className:"bg-gray-600 mb-4 px-2 py-2 w-full lg:w-[20em] rounded-lg text-white placeholder:text-gray-200 outline-none",placeholder:"Product Description"})}),e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("input",{type:"text",value:a.fabric,onChange:t=>l({...a,fabric:t.target.value}),name:"fabric",className:"bg-gray-600 mb-4 px-2 py-2 w-full lg:w-[20em] rounded-lg text-white placeholder:text-gray-200 outline-none",placeholder:"Fabric"})}),e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("textarea",{cols:"30",rows:"5",name:"washCareInstructions",value:a.washCareInstructions,onChange:t=>l({...a,washCareInstructions:t.target.value}),className:"bg-gray-600 mb-4 px-2 py-2 w-full lg:w-[20em] rounded-lg text-white placeholder:text-gray-200 outline-none",placeholder:"Wash Care Instructions"})}),e.jsxs("div",{className:"flex justify-center mb-4 px-4",children:[e.jsx("label",{className:"text-white mb-2",children:"Add Size"}),["xs","s","m","l","xl"].map(t=>e.jsxs("label",{className:"text-white mb-2",children:[e.jsx("input",{type:"checkbox",checked:a.sizes&&a.sizes.includes(t),onChange:()=>P(t),className:"mr-2"}),t.toUpperCase()]},t))]}),e.jsxs("div",{className:"flex justify-center mb-3",children:[e.jsx("button",{onClick:D,className:"bg-yellow-500 w-50 text-black font-bold px-2 py-2 rounded-lg",children:"Update Product"}),e.jsx(U,{to:"/dashboard",className:"bg-yellow-500 text-black font-bold px-4 py-2 mx-2 rounded-lg",children:"Back"})]})]})]})})})})};export{Y as default};
