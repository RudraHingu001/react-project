import{r as a,R as I,j as o,Q as l}from"./index-08a8fb75.js";import{m as S}from"./myContext-0ad30525.js";import{L as b}from"./Layout-78a1f288.js";import j from"./Loader-70be2f1c.js";import{a as m}from"./FirebaseConfig-f1ddf40d.js";import{T as $}from"./table-0978d881.js";import{a as H}from"./axios-1779699b.js";import"./index-bea2a320-8c0c8ce8.js";function _(){const u=a.useContext(S),{loading:p,order:i}=u,[n,f]=a.useState([]),[c,g]=a.useState({}),d=m.currentUser?m.currentUser.email:null;a.useEffect(()=>{if(d){const e=i.filter(s=>s.email===d);f(e)}},[i,d]);const x=async e=>{var s,r;if(!e)return l.error("Shipment ID is required."),null;try{return(await H.get(`https://endpoints-ashy.vercel.app/api/track/track/${e}`)).data}catch(t){return console.error("Error tracking shipment:",t),l.error("Error tracking shipment: "+(((r=(s=t.response)==null?void 0:s.data)==null?void 0:r.message)||t.message)),null}};a.useEffect(()=>{const e=async()=>{const s={};for(const r of n)if(r.shipmentId){const t=await x(r.shipmentId);s[r.shipmentId]=t?t.current_status:"Not Available"}g(s)};n.length>0&&e()},[n]);const h=I.useMemo(()=>[{Header:"Order Id",accessor:"uniqueOrderId"},{Header:"Name",accessor:e=>e.addressInfo.name},{Header:"Address",accessor:e=>`${e.addressInfo.roomNo||""}, ${e.addressInfo.society||""}, ${e.addressInfo.street||""}, ${e.addressInfo.city||""} , ${e.addressInfo.pincode}`},{Header:"Phone Number",accessor:e=>e.addressInfo.phoneNumber},{Header:"Email",accessor:"email"},{Header:"Date",accessor:e=>e.date},{Header:"Product Info",accessor:e=>{const s=e.cartItems.map(r=>{const t=r.colors.find(y=>y.hex===r.selectedColor),v=t?t.name:"Unknown Color";return`
              <div style="margin-bottom: 20px; border-bottom: 1px solid #ddd; padding-bottom: 10px;">
                <div style="text-align: center;">
                  <img src="${r.imageUrls[0]}" alt="${r._id}" style="max-width: 150px; height: auto; display: block; margin: 0 auto;" />
                </div>
                <div style="text-align: center;">
                  <div><strong>Product Name:</strong> ${r._id}</div>
                  <div><strong>Category:</strong> ${r.category}</div>
                  <div><strong>Color:</strong> ${v}</div>
                  <div><strong>Size:</strong> ${r.selectedSize}</div>
                  <div><strong>Quantity:</strong> ${r.quantity}</div>
                </div>
              </div>
            `}).join("<br/><br/>");return o.jsx("div",{dangerouslySetInnerHTML:{__html:s}})}},{Header:"Total",accessor:"grandTotal"},{Header:"Payment Status",accessor:e=>e.status},{Header:"Order Shipping Status",accessor:e=>c[e.shipmentId]||"Pending"}],[c]);return o.jsxs(b,{children:[p&&o.jsx(j,{}),o.jsxs("div",{className:"flex flex-col",style:{marginBottom:"15rem"},children:[o.jsx("div",{className:"w-full",children:o.jsx("h2",{className:"text-center text-3xl font-bold mb-4",style:{color:"#3C2A21",marginTop:"3rem"},children:"Order Details"})}),o.jsx("div",{className:"w-full overflow-x-auto items-center justify-center",children:o.jsx($,{columns:h,data:n})})]})]})}export{_ as default};
