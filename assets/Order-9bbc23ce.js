import{j as t,r as n,R as j,Q as f}from"./index-c51dd4bb.js";import{m as N}from"./myContext-a654731c.js";import{L as S}from"./Layout-84b16dcf.js";import P from"./Loader-9f77985f.js";import{a as b}from"./FirebaseConfig-f1ddf40d.js";import{r as y}from"./index-034c864f.js";import{a as I}from"./axios-1779699b.js";import"./index-bea2a320-8c0c8ce8.js";function w({columns:p,data:i}){const{getTableProps:l,getTableBodyProps:d,headerGroups:x,prepareRow:g,page:u,nextPage:c,previousPage:h,canPreviousPage:m,canNextPage:e,state:{pageIndex:a,pageSize:r}}=y.useTable({columns:p,data:i,initialState:{pageIndex:0,pageSize:5}},y.useSortBy,y.usePagination);return t.jsx("div",{className:"container mx-auto bg-white rounded-lg shadow-lg overflow-hidden p-0",children:i.length===0?t.jsx("div",{className:"flex flex-col items-center justify-center my-8",children:t.jsx("p",{className:"text-gray-500 text-lg",children:"No data to display"})}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{...l(),className:"min-w-full text-sm text-left text-gray-500",children:[t.jsx("thead",{className:"text-xs text-black uppercase bg-gray-200 border border-gray-600 shadow-[inset_0_0_8px_rgba(0,0,0,0.6)]",children:x.map(s=>n.createElement("tr",{...s.getHeaderGroupProps(),key:s.id},s.headers.map(o=>n.createElement("th",{...o.getHeaderProps(o.getSortByToggleProps()),className:"px-4 py-2 cursor-pointer",key:o.id},o.render("Header"),o.isSorted?o.isSortedDesc?" ▼":" ▲":""))))}),t.jsx("tbody",{...d(),className:"bg-white divide-y divide-gray-200",children:u.map(s=>(g(s),n.createElement("tr",{...s.getRowProps(),className:"hover:bg-gray-100 transition-colors duration-200",key:s.id},s.cells.map(o=>n.createElement("td",{...o.getCellProps(),className:"px-4 py-2",key:o.column.id},o.render("Cell"))))))})]})}),t.jsx("div",{className:"flex items-center justify-between mt-4 px-4 py-2 bg-gray-200",children:t.jsxs("div",{children:[t.jsx("button",{onClick:h,disabled:!m,className:`px-4 py-2 rounded-lg ${m?"bg-[#3C2A21] text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"Previous"}),t.jsxs("span",{className:"mx-4 text-gray-600",children:["Page ",t.jsx("strong",{children:a+1})," of ",t.jsx("strong",{children:Math.ceil(i.length/r)})]}),t.jsx("button",{onClick:c,disabled:!e,className:`px-4 py-2 rounded-lg ${e?"bg-[#3C2A21] text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"Next"})]})})]})})}function U(){const p=n.useContext(N),{loading:i,order:l}=p,[d,x]=n.useState([]),[g,u]=n.useState({}),c=b.currentUser?b.currentUser.email:null;n.useEffect(()=>{if(c){const e=l.filter(a=>a.email===c);e.sort((a,r)=>new Date(r.date)-new Date(a.date)),x(e)}},[l,c]);const h=async e=>{var a,r;if(!e)return f.error("Shipment ID is required."),null;try{return(await I.get(`https://endpoints-ashy.vercel.app/api/track/track/${e}`)).data}catch(s){return console.error("Error tracking shipment:",s),f.error("Error tracking shipment: "+(((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||s.message)),null}};n.useEffect(()=>{const e=async()=>{const a={};for(const r of d)if(r.shipmentId){const s=await h(r.shipmentId);a[r.shipmentId]=s?s.current_status:"Not Available"}u(a)};d.length>0&&e()},[d]);const m=j.useMemo(()=>[{Header:"Order Id",accessor:"uniqueOrderId"},{Header:"Name",accessor:e=>e.addressInfo.name},{Header:"Address",accessor:e=>`${e.addressInfo.roomNo||""}, ${e.addressInfo.society||""}, ${e.addressInfo.street||""}, ${e.addressInfo.city||""} , ${e.addressInfo.pincode}`},{Header:"Phone Number",accessor:e=>e.addressInfo.phoneNumber},{Header:"Email",accessor:"email"},{Header:"Date",accessor:e=>e.date},{Header:"Product Info",accessor:e=>{const a=e.cartItems.map(r=>{const s=r.colors.find(v=>v.hex===r.selectedColor),o=s?s.name:"Unknown Color";return`
              <div style="margin-bottom: 20px; border-bottom: 1px solid #ddd; padding-bottom: 10px;">
                <div style="text-align: center;">
                  <img src="${r.imageUrls[0]}" alt="${r._id}" style="max-width: 150px; height: auto; display: block; margin: 0 auto;" />
                </div>
                <div style="text-align: center;">
                  <div><strong>Product Name:</strong> ${r._id}</div>
                  <div><strong>Category:</strong> ${r.category}</div>
                  <div><strong>Color:</strong> ${o}</div>
                  <div><strong>Size:</strong> ${r.selectedSize}</div>
                  <div><strong>Quantity:</strong> ${r.quantity}</div>
                </div>
              </div>
            `}).join("<br/><br/>");return t.jsx("div",{dangerouslySetInnerHTML:{__html:a}})}},{Header:"Total",accessor:"grandTotal"},{Header:"Payment Status",accessor:e=>e.status},{Header:"Order Shipping Status",accessor:e=>g[e.shipmentId]||"Pending"}],[g]);return t.jsxs(S,{children:[i&&t.jsx(P,{}),t.jsxs("div",{className:"flex flex-col",style:{marginBottom:"15rem"},children:[t.jsx("div",{className:"w-full",children:t.jsx("h2",{className:"text-center text-3xl font-bold mb-4",style:{color:"#3C2A21",marginTop:"3rem"},children:"Order Details"})}),t.jsx("div",{className:"w-full overflow-x-auto items-center justify-center",children:t.jsx(w,{columns:m,data:d})})]})]})}export{U as default};
