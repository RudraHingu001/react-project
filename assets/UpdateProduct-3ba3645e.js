import{i as I,a as P,r as o,j as e,Q as b}from"./index-dd4f4c9f.js";import{a as m}from"./axios-1779699b.js";import{L as z}from"./Layout-0311dea1.js";import F from"./Loader-cdb4d57f.js";import{S as q}from"./Google-268d10b0.js";import{n as E}from"./index-e00ecf1c.js";const R=()=>{const{productId:i}=I(),g=P(),[t,l]=o.useState({name:"",price:"",category:"",description:"",sizes:[],fabric:"",washCareInstructions:"",colors:[],imageFiles:[]}),[f,j]=o.useState([]),[p,u]=o.useState(!1),[n,x]=o.useState(""),[y,h]=o.useState("");o.useEffect(()=>{m.get("https://endpoints-ashy.vercel.app/api/products/categories").then(s=>{j(s.data.categories)}).catch(s=>{console.error("Error fetching categories:",s)}),m.get(`https://endpoints-ashy.vercel.app/api/products/getproducts/${i}`).then(s=>{const a=s.data,r=a.sizes[0].split(","),d=JSON.parse(a.colors);console.log(a),l({name:a.name,price:a.price,category:a.category,description:a.description,sizes:r,fabric:a.fabric,washCareInstructions:a.washCareInstructions,colors:d,imageFiles:[]})}).catch(s=>{console.error("Error fetching product details:",s)})},[i]);const c=s=>{const{name:a,value:r}=s.target;l(d=>({...d,[a]:r}))},N=s=>{l(a=>({...a,imageFiles:Array.from(s.target.files)}))},C=s=>{const a=[...t.sizes];a.includes(s)?a.splice(a.indexOf(s),1):a.push(s),l({...t,sizes:a})},v=s=>{x(s.hex);const a=E(s.hex);h(a.basic[0].name)},k=()=>{n&&!t.colors.some(s=>s.hex===n)&&(l({...t,colors:[...t.colors,{hex:n,name:y}]}),x(""),h(""))},w=s=>{l({...t,colors:t.colors.filter(a=>a.hex!==s)})},S=async s=>{s.preventDefault(),u(!0);const a=new FormData;a.append("name",t.name),a.append("price",t.price),a.append("category",t.category),a.append("description",t.description),a.append("sizes",t.sizes),a.append("fabric",t.fabric),a.append("washCareInstructions",t.washCareInstructions),a.append("colors",JSON.stringify(t.colors));for(let r of t.imageFiles)a.append("images",r);try{const r=await m.put(`https://endpoints-ashy.vercel.app/api/products/updateproduct/${i}`,a,{headers:{"Content-Type":"multipart/form-data"}});b.success(r.data.message),g("/dashboard")}catch{b.error("Error updating product")}finally{u(!1)}};return e.jsx(z,{children:e.jsx("div",{className:"flex justify-center items-center h-screen",style:{marginBottom:"5rem"},children:e.jsx("div",{className:"w-full max-w-4xl",children:e.jsxs("div",{className:"px-10 py-10 rounded-xl",style:{backgroundColor:"#f5f5dc",maxHeight:"90vh",overflowY:"auto"},children:[p&&e.jsx(F,{}),e.jsx("h1",{className:"text-center text-black text-xl mb-4 font-bold",children:"Update Product"}),e.jsxs("form",{onSubmit:S,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-black",children:"Product Name"}),e.jsx("input",{type:"text",name:"name",value:t.name,onChange:c,className:"bg-gray-300 px-2 py-2 w-full rounded-lg",placeholder:"Product Name",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-black",children:"Price"}),e.jsx("input",{type:"number",name:"price",value:t.price,onChange:c,className:"bg-gray-300 px-2 py-2 w-full rounded-lg",placeholder:"Product Price",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-black",children:"Category"}),e.jsxs("select",{name:"category",value:t.category,onChange:c,className:"bg-gray-300 px-2 py-2 w-full rounded-lg",required:!0,children:[e.jsx("option",{value:"",children:"Select a category"}),f.map(s=>e.jsx("option",{value:s._id,children:s.name},s._id))]})]}),e.jsxs("div",{className:"flex flex-col mb-4",children:[e.jsx("label",{className:"text-black mb-2",children:"Add Size"}),e.jsx("div",{className:"flex flex-wrap items-center px-4",children:["s","m","l","xl"].map(s=>e.jsxs("label",{className:"flex items-center text-black mr-2 mb-2",children:[e.jsx("input",{type:"checkbox",checked:t.sizes.includes(s),onChange:()=>C(s),className:"mr-2"}),s.toUpperCase()]},s))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-black",children:"Description"}),e.jsx("textarea",{name:"description",value:t.description,onChange:c,className:"bg-gray-300 px-2 py-2 w-full rounded-lg",placeholder:"Product Description",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-black",children:"Fabric"}),e.jsx("input",{type:"text",name:"fabric",value:t.fabric,onChange:c,className:"bg-gray-300 px-2 py-2 w-full rounded-lg",placeholder:"Fabric",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-black",children:"Wash Care Instructions"}),e.jsx("textarea",{name:"washCareInstructions",value:t.washCareInstructions,onChange:c,className:"bg-gray-300 px-2 py-2 w-full rounded-lg",placeholder:"Wash Care Instructions",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-black",children:"Product Images"}),e.jsx("input",{type:"file",name:"images",onChange:N,multiple:!0,className:"bg-gray-300 px-2 py-2 w-full rounded-lg"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-black text-center",children:"Select Colors"}),e.jsxs("center",{children:[e.jsx(q,{color:n,onChangeComplete:v}),e.jsx("button",{type:"button",onClick:k,className:"bg-yellow-500 text-black font-bold px-2 py-1 rounded-lg mt-3",children:"Add Color"})]})]}),e.jsxs("div",{className:"mb-4 flex justify-center items-center",children:[e.jsx("label",{className:"block text-black",children:"Colors Selected : Â "}),t.colors.map((s,a)=>e.jsxs("div",{className:"flex items-center mr-4 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full",style:{backgroundColor:s.hex}}),e.jsx("span",{className:"text-black ml-2",children:s.name}),e.jsx("button",{onClick:()=>w(s.hex),className:"bg-red-500 text-white font-bold px-2 py-1 rounded-lg ml-2",children:"Remove"})]},a))]}),e.jsx("button",{type:"submit",className:"bg-yellow-500 text-black font-bold px-2 py-2 rounded-lg w-full",children:p?"Loading...":"Update Product"})]})]})})})})};export{R as default};
